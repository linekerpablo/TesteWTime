CREATE DATABASE TesteWTime;
go
use TesteWTime;

DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'TesteWTime.Infra.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201710142227096_AutomaticMigration'
BEGIN
    CREATE TABLE [dbo].[Urls] (
        [UrlId] [bigint] NOT NULL IDENTITY,
        [Hits] [bigint] NOT NULL,
        [Url] [varchar](max) NOT NULL,
        [ShortUrl] [varchar](255) NOT NULL,
        CONSTRAINT [PK_dbo.Urls] PRIMARY KEY ([UrlId])
    )
    CREATE TABLE [dbo].[Users] (
        [UserId] [bigint] NOT NULL IDENTITY,
        [Name] [varchar](255) NOT NULL,
        CONSTRAINT [PK_dbo.Users] PRIMARY KEY ([UserId])
    )
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201710142227096_AutomaticMigration', N'TesteWTime.Infra.Migrations.Configuration',  0x1F8B0800000000000400CD58DB6EDB46107D2FD07F20F6D9E1DA4E53340695C095EC5668641BA19C3CAFC891B4E872C9EE2E0DE9DBFAD04FEA2F7496F78BEE76E2C28021AD66CEDCCECE0CF9EFDFFF781F5791709E40691ECB01B970CF89033288432E1703929AF99B5FC8C70F3FFEE0DD84D1CAF952CABDB572A829F5802C8D49AE28D5C11222A6DD88072AD6F1DCB8411C5116C6F4F2FCFC3DBDB8A0801004B11CC7FB9C4AC323C8BEE0D7612C03484CCAC4240E41E8E21C7FF13354E78E45A01316C0804C411BF83A456D772CE78AB9A86C606588732D38437F7C1073E2302963C30C7A7BF5A8C1372A960B3FC10326A6EB04506ECE8486228AAB5AFCD080CE2F6D40B4562CA182549B383A12F0E26D9121DA553F29CFA4CA20E6F006736DD636EA2C8F03F2A884264ED7D0D550282BD44AF10825B87433080EDAB5AA674E4FE0ACA20632C8FE9D39C3549854C140426A141367CE433A133CF803D6D3F84F9003990AD174131DC5DF5A0778F4A0E20494597F8679EDFC38240E6DABD2AE6EA5D956CB031C4BF3F34FC4B94317D84C40C58546327C132BF80D242866207C60C680C2528E43C8B2D973A063EE776EF43E6BBB11D0E11200D98BD7913813B6FA0472619603821F8973CB5710962705E8A3E4787B51C9A8148E36EA2F6365765BBE7CF7EEF9963D5A9372375535F2EA54AE5ADD57262BBA70125B0BBDEF4557FBFF756B6EBB38D60654E1515DB5AABFF74880592A78A00B0FDA41E6C83E9846DF4332D56EE4C3C2CDFB21DDA36CD9B4513BA7E8A650ABA0EA8146F389564E3EBA65F4791396245886C6282C4E1C3F9F83C337FEF1A321CA3168A0374C88CADBCA12928A2DA0F32B9A464F6FB9D266C40C9B315BE86118F5C4FA25DC92E1D25EB34ADDBB55A7BD94B69FBB5C69AF0479613B4875266F31B808EF47162754DE14F3B1A7966D234C30B579B20C63914672C78CDA85918F8B26447E723842D6B43B3E1CA35F77FE26487DDA47F268278FDD92D15ECD3A5DB04B80C3E891DFC397E14776754F20C866BDADB529BA79AB3C1B27C32E94BC473731F293EF5C995E6FEB8A54D6AB1ED7E9655ED157F6EFFABD46938B100753F3C443DB64FC35D63672AD80EBFF25868263BCB5C084493EC7F2E7639CE0A27DD97950F8FF2CED54EB501CB0B9BFD2D23CE30B6E53BB77D53872E76CAECAA58DD377E527A6822553FD65F9999BF026DC6C2D7AC93DF7D536CC6F55DBE65EF92D32D8DD1AFB9BC9FE8D70EB4298379B01096731C6907B78F8AAB87D53DC88FBAC25B2DF503DDA7CC5E28D40F3450D615FB848086CA7AA414B191C917159468CA9E95129D2A9F2040C0B31E1D7CAF0390B0CFE1C80D6D953C417265214B98966108EE57D6A92D45C6B0DD14CB49E4A3CBADB7EB629B77DF6EE13FB4DBF4408E826C710E05EFE9A7211567EDF6E60E41608CBBDE2EAA057F81485708B75857417CB03818AF48D2001692FDE14A2442098BE973E7B82537C437A7D82050BD6E55CDC0EB2BF10EDB47B23CE168A45BAC0A8F5ED6B436ADF1B7EF80F7FAC099269140000 , N'6.1.3-40302')
END

